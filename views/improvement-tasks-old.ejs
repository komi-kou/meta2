<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¢ºèªäº‹é … - Metaåºƒå‘Šãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
    <link rel="stylesheet" href="/style.css">
    <style>
        /* ç¢ºèªäº‹é …ãƒšãƒ¼ã‚¸å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .app-container {
            display: flex;
            min-height: 100vh;
            background: #f5f6fa;
        }

        .main-content {
            flex: 1;
            padding: 20px;
            background-color: #f9fafb;
        }

        .checklist-page {
            max-width: 1000px;
            margin: 0 auto;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 16px 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .page-header h2 {
            margin: 0;
            color: #374151;
            font-size: 24px;
            font-weight: 600;
        }

        .header-info {
            color: #6b7280;
            font-size: 14px;
        }

        .no-content {
            text-align: center;
            padding: 60px 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .no-content-icon {
            font-size: 48px;
            margin-bottom: 16px;
            display: block;
        }

        .no-content h3 {
            color: #059669;
            margin: 0;
            font-size: 18px;
        }

        .content-container {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        /* ã‚¢ãƒ©ãƒ¼ãƒˆå†…å®¹é¢¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .alert-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .alert-header {
            background-color: #fef3c7;
            padding: 14px 16px;
            border-bottom: 1px solid #f59e0b;
        }

        .alert-title-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .alert-icon {
            font-size: 18px;
            margin-right: 8px;
        }

        .alert-metric {
            font-weight: 600;
            color: #92400e;
            font-size: 16px;
        }

        .alert-timestamp {
            color: #a16207;
            font-size: 12px;
        }

        .alert-message-row {
            color: #92400e;
            font-size: 14px;
            line-height: 1.4;
        }

        .alert-content {
            padding: 0;
        }

        .checklist-item {
            padding: 14px 16px;
            border-bottom: 1px solid #f3f4f6;
            background-color: #fef9e7;
        }

        .checklist-item:last-child {
            border-bottom: none;
        }

        .item-priority {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .priority-indicator {
            margin-right: 8px;
            font-size: 16px;
        }

        .priority-text {
            font-weight: 500;
            color: #374151;
            flex: 1;
        }

        .item-timestamp {
            color: #6b7280;
            font-size: 12px;
            margin-bottom: 8px;
        }

        .item-description {
            color: #6b7280;
            font-size: 14px;
            line-height: 1.5;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .main-content {
                margin-left: 0;
                padding: 10px;
            }
            
            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .alert-title-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h3>Metaåºƒå‘Šãƒ¬ãƒãƒ¼ãƒˆ</h3>
            </div>
            <nav class="sidebar-nav">
                <a href="/dashboard" class="nav-item">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a>
                <a href="/alerts" class="nav-item">ã‚¢ãƒ©ãƒ¼ãƒˆå†…å®¹</a>
                <a href="/alert-history" class="nav-item">ã‚¢ãƒ©ãƒ¼ãƒˆå±¥æ­´</a>
                <a href="/improvement-tasks" class="nav-item active">ç¢ºèªäº‹é …</a>
                <a href="/improvement-strategies" class="nav-item">æ”¹å–„æ–½ç­–</a>
                <a href="/chatwork-test" class="nav-item">ãƒãƒ£ãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ</a>
            </nav>
        </div>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <div class="main-content">
            <div class="checklist-page">
                <div class="page-header">
                    <h2>ğŸ“‹ ç¢ºèªäº‹é …</h2>
                    <div class="header-info">
                        ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ãƒ©ãƒ¼ãƒˆ: <span id="alertCount">4</span>ä»¶ 
                        æœ€çµ‚ãƒã‚§ãƒƒã‚¯: <span id="lastCheckTime"></span>
                    </div>
                </div>

                <div id="content">
                    <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯JavaScriptã§ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ç¢ºèªäº‹é …ã®å®šç¾©
        const checklistRules = {
            'äºˆç®—æ¶ˆåŒ–ç‡': [
                { priority: 1, title: 'é…ä¿¡ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª', description: 'åºƒå‘ŠãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ãªã£ã¦ã„ã‚‹ã‹' },
                { priority: 2, title: 'é…ä¿¡ã™ã‚‹ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãŒæ¯ã‚Œã¦ã„ã‚‹', description: 'CVæ•°ãŒ0ã‚‚ã—ãã¯ç›®æ¨™CPAã®åˆ°é”ã—ã¦ãŠã‚‰ãšäºˆç®—ã‚‚æ¶ˆåŒ–ã•ã‚Œã¦ã„ãªã„' },
                { priority: 3, title: 'é…ä¿¡ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼å±¤ãŒæ‚ªã„ã®ã‹', description: 'é…ä¿¡ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼å±¤ãŒæ‚ªã„ã¨è¡¨ç¤ºã•ã‚Œãªã„ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹' }
            ],
            'CTR': [
                { priority: 1, title: 'é…ä¿¡ã—ã¦ã„ã‚‹ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãŒåˆºã•ã£ã¦ã„ãªã„oræ¯ã‚Œã¦ã„ã‚‹', description: 'ã‚ã‚ŠããŸã‚Šã®ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¦‹ã‚‰ã‚Œã¦ã„ãªã„\n7æ—¥é–“ãƒ™ãƒ¼ã‚¹ã§ãšã£ã¨é…ä¿¡ã—ã¦ã„ã¦ã€é£½ãã‚‰ã‚Œã¦ã„ã‚‹' },
                { priority: 2, title: 'ãƒ•ãƒªãƒ¼ã‚¯ã‚¨ãƒ³ã‚·ãƒ¼ãŒ2.5%ä»¥ä¸Šã‚ã‚‹', description: 'åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã°ã‹ã‚Šã«é…ä¿¡ã•ã‚Œã¦ã„ã¦ã€è¦‹é£½ãã‚‰ã‚Œã¦ã„ã‚‹' },
                { priority: 3, title: 'é…ä¿¡ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼å±¤ãŒè¦‹è¾¼ã¿é¡§å®¢ã§ã¯ãªã„', description: 'ã‚µãƒ¼ãƒ“ã‚¹ã«åˆã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼å±¤ã«é…ä¿¡ã•ã‚Œã¦ã„ãªã„ã®ã§ã€ã‚¹ãƒ«ãƒ¼ã•ã‚Œã¦ã„ã‚‹' }
            ],
            'CPM': [
                { priority: 1, title: 'æœ€é©ãªCPMå€¤ã§é…ä¿¡ã§ãã¦ã„ãªã„', description: 'ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãŒåˆºã•ã£ã¦ã„ãªã„ãŸã‚å…¥åŠ›ã—ãŸCPMã‹ã‚‰ä¹–é›¢ã—ã¦ã„ã‚‹\né…ä¿¡ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼å±¤ãŒæ‚ªã„ãŸã‚å…¥åŠ›ã—ãŸCPMã‹ã‚‰ä¹–é›¢ã—ã¦ã„ã‚‹' }
            ],
            'CV': [
                { priority: 1, title: 'ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãŒåˆºã•ã£ã¦ã„ãªã„orã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãŒæ¯ã‚Œã¦ã„ã‚‹', description: 'å…¥å£ã®ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã§é­…åŠ›çš„ã«é­…ã›ã‚Œã¦ã„ãªã„oré£½ãã‚‰ã‚Œã¦ã—ã¾ã£ã¦ã„ã‚‹' },
                { priority: 2, title: 'é…ä¿¡ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼å±¤ãŒã‚ºãƒ¬ã¦ã„ã‚‹', description: 'è³¼å…¥è¦‹è¾¼ã¿ã®ä½ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é…ä¿¡ã•ã‚Œã¦ã„ã‚‹' },
                { priority: 3, title: 'LPã§é›¢è„±ã•ã‚Œã¦ã„ã‚‹', description: 'LPã®å†…å®¹ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã«åˆºã•ã£ã¦ã„ãªã„' }
            ],
            'CPA': [
                { priority: 1, title: 'ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãŒåˆºã•ã£ã¦ã„ãªã„orã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãŒæ¯ã‚Œã¦ã„ã‚‹', description: '' },
                { priority: 2, title: 'é…ä¿¡ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼å±¤ãŒã‚ºãƒ¬ã¦ã„ã‚‹', description: 'è³¼å…¥è¦‹è¾¼ã¿ã®ä½ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é…ä¿¡ã•ã‚Œã¦ã„ã‚‹' },
                { priority: 3, title: 'å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãŒé©åˆ‡ã§ã¯ãªã„', description: 'ãƒ”ã‚¯ã‚»ãƒ«ã§å­¦ç¿’ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒèª¤ã£ãŸæ–¹å‘ã«é€²ã‚“ã§ã„ã‚‹' },
                { priority: 4, title: 'LPã§é›¢è„±ã•ã‚Œã¦ã„ã‚‹', description: 'LPã®å†…å®¹ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã«åˆºã•ã£ã¦ã„ãªã„' }
            ],
            'æ—¥äºˆç®—': [
                { priority: 1, title: 'äºˆç®—è¨­å®šãŒé©åˆ‡ã§ãªã„', description: 'è¨­å®šã—ãŸæ—¥äºˆç®—ãŒå¸‚å ´ã®ç«¶åˆçŠ¶æ³ã«åˆã£ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹' },
                { priority: 2, title: 'é…ä¿¡æ™‚é–“å¸¯ã®è¨­å®šå•é¡Œ', description: 'åŠ¹æœçš„ãªæ™‚é–“å¸¯ã«é…ä¿¡ã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹' }
            ]
        };

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('=== ç¢ºèªäº‹é …ãƒšãƒ¼ã‚¸: åˆæœŸåŒ–é–‹å§‹ ===');
            await generateChecklist();
            updateLastCheckTime();
        });

        // ç¢ºèªäº‹é …ã‚’ç”Ÿæˆï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®checkItemsã‚’å„ªå…ˆä½¿ç”¨ï¼‰
        async function generateChecklist() {
            console.log('=== ç¢ºèªäº‹é …ç”Ÿæˆé–‹å§‹ ===');
            
            // ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ç”Ÿæˆã•ã‚ŒãŸcheckItemsã‚’ä½¿ç”¨
            const serverCheckItems = <%- JSON.stringify(checkItems || []) %>;
            console.log('=== ç¢ºèªäº‹é …ãƒšãƒ¼ã‚¸ãƒ‡ãƒãƒƒã‚° ===');
            console.log('ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®checkItems:', serverCheckItems);
            console.log('checkItemsæ•°:', serverCheckItems ? serverCheckItems.length : 0);
            
            // ãƒ‡ãƒãƒƒã‚°ç”¨: ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æ¸¡ã•ã‚ŒãŸã‚¢ãƒ©ãƒ¼ãƒˆæƒ…å ±ã‚‚ç¢ºèª
            console.log('ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æ¸¡ã•ã‚ŒãŸã‚¢ãƒ©ãƒ¼ãƒˆæƒ…å ±ã‚’ç¢ºèªä¸­...');
            
            let currentAlerts = [];
            
            // ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®checkItemsãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆç©ºé…åˆ—å«ã‚€ï¼‰ã¯ä½¿ç”¨
            if (serverCheckItems !== null && serverCheckItems !== undefined) {
                console.log('âœ… ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®checkItemsã‚’ä½¿ç”¨:', serverCheckItems.length + 'ä»¶');
                
                if (serverCheckItems.length > 0) {
                    // checkItemsã‹ã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆæƒ…å ±ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
                    const alertGroups = {};
                    serverCheckItems.forEach(item => {
                        if (!alertGroups[item.metric]) {
                            alertGroups[item.metric] = {
                                id: Date.now() + Math.random(),
                                metric: item.metric,
                                message: item.message,
                                level: 'medium',
                                timestamp: new Date().toISOString(),
                                checkItems: []
                            };
                        }
                        alertGroups[item.metric].checkItems.push(item);
                    });
                    
                    currentAlerts = Object.values(alertGroups);
                } else {
                    console.log('âœ… ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ç©ºã®checkItems - ã‚¢ãƒ©ãƒ¼ãƒˆãªã—çŠ¶æ…‹');
                    currentAlerts = [];
                }
                
            } else {
                console.log('âš ï¸ ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®checkItemsãŒãªã„ã€APIã‹ã‚‰å–å¾—');
                
                try {
                    // APIã‹ã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆå±¥æ­´ã‚’å–å¾—
                    const alertResponse = await fetch('/api/alert-history');
                    const alertData = await alertResponse.json();
                    
                    if (alertData.success && alertData.history && alertData.history.length > 0) {
                        currentAlerts = alertData.history.slice(0, 10);
                        console.log('âœ… APIã‹ã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆå–å¾—:', currentAlerts.length + 'ä»¶');
                    } else {
                        console.log('âŒ APIã‹ã‚‰ã®ã‚¢ãƒ©ãƒ¼ãƒˆå–å¾—å¤±æ•—ã€ã‚¢ãƒ©ãƒ¼ãƒˆãªã—çŠ¶æ…‹');
                        currentAlerts = []; // ã‚¢ãƒ©ãƒ¼ãƒˆãªã—çŠ¶æ…‹
                    }
                } catch (error) {
                    console.error('ã‚¢ãƒ©ãƒ¼ãƒˆå–å¾—ã‚¨ãƒ©ãƒ¼:', error);
                    currentAlerts = [];
                }
            }

            // ç¢ºèªäº‹é …ã‚’ç”Ÿæˆ
            const generatedChecklist = [];
            
            console.log('=== ç¢ºèªäº‹é …ç”Ÿæˆãƒ‡ãƒãƒƒã‚° ===');
            console.log('å‡¦ç†å¯¾è±¡ã‚¢ãƒ©ãƒ¼ãƒˆæ•°:', currentAlerts.length);
            
            currentAlerts.forEach((alert, index) => {
                console.log(`--- ã‚¢ãƒ©ãƒ¼ãƒˆ ${index + 1} ---`);
                console.log('ãƒ¡ãƒˆãƒªãƒƒã‚¯:', alert.metric);
                console.log('alertå…¨ä½“:', alert);
                console.log('checkItems:', alert.checkItems);
                console.log('checkItems type:', typeof alert.checkItems);
                console.log('checkItems length:', alert.checkItems ? alert.checkItems.length : 'undefined');
                console.log('checklistRules[metric]:', checklistRules[alert.metric]);
                console.log('checkItemsé…åˆ—ç¢ºèª:', Array.isArray(alert.checkItems));
                console.log('checkItemså†…å®¹è©³ç´°:', alert.checkItems);
                
                // APIã‹ã‚‰å–å¾—ã—ãŸç¢ºèªäº‹é …ã‚’å„ªå…ˆä½¿ç”¨ã€ãªã‘ã‚Œã°ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
                let items = [];
                
                // ã¾ãšAPIã‹ã‚‰å–å¾—ã—ãŸcheckItemsã‚’ç¢ºèª
                if (alert.checkItems && Array.isArray(alert.checkItems) && alert.checkItems.length > 0) {
                    items = alert.checkItems;
                    console.log(`âœ… ${alert.metric}: APIã®checkItemsã‚’ä½¿ç”¨ (${items.length}ä»¶)`);
                } else {
                    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ«ãƒ¼ãƒ«ã‚’ä½¿ç”¨
                    items = checklistRules[alert.metric] || [];
                    console.log(`âš ï¸ ${alert.metric}: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ«ãƒ¼ãƒ«ã‚’ä½¿ç”¨ (${items.length}ä»¶)`);
                }
                
                console.log(`${alert.metric} - ä½¿ç”¨ã™ã‚‹ç¢ºèªäº‹é …:`, items);
                console.log(`${alert.metric} - ç¢ºèªäº‹é …æ•°:`, items.length);
                console.log(`${alert.metric} - æ¡ä»¶åˆ¤å®š:`, {
                    hasCheckItems: !!alert.checkItems,
                    checkItemsLength: alert.checkItems ? alert.checkItems.length : 0,
                    checkItemsGreaterThanZero: alert.checkItems && alert.checkItems.length > 0,
                    fallbackRuleExists: !!checklistRules[alert.metric],
                    fallbackRuleLength: checklistRules[alert.metric] ? checklistRules[alert.metric].length : 0,
                    finalItemsLength: items.length
                });
                
                // ã‚¢ã‚¤ãƒ†ãƒ ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ç¢ºèªäº‹é …ã‚’ç”Ÿæˆ
                if (items && items.length > 0) {
                    const checklistItem = {
                        metric: alert.metric,
                        alertMessage: alert.message,
                        alertLevel: alert.level || alert.severity,
                        timestamp: alert.timestamp,
                        items: items
                    };
                    
                    generatedChecklist.push(checklistItem);
                    console.log(`âœ… ${alert.metric} ã®ç¢ºèªäº‹é …ã‚’è¿½åŠ :`, {
                        metric: checklistItem.metric,
                        itemsCount: checklistItem.items.length,
                        items: checklistItem.items.map(item => item.title || item)
                    });
                } else {
                    console.log(`âŒ ${alert.metric} ã®ç¢ºèªäº‹é …ãŒè¦‹ã¤ã‹ã‚‰ãªã„ - items:`, items);
                }
            });
            
            // ã‚¢ãƒ©ãƒ¼ãƒˆæ•°ã‚’æ›´æ–°
            document.getElementById('alertCount').textContent = currentAlerts.length;

            console.log('ç”Ÿæˆã•ã‚ŒãŸç¢ºèªäº‹é …:', generatedChecklist);
            renderChecklist(generatedChecklist);
        }

        // ç¢ºèªäº‹é …ã‚’è¡¨ç¤º
        function renderChecklist(checklist) {
            const contentDiv = document.getElementById('content');
            
            if (checklist.length === 0) {
                contentDiv.innerHTML = `
                    <div class="no-content">
                        <div class="no-content-icon">âœ…</div>
                        <h3>ç¢ºèªãŒå¿…è¦ãªé …ç›®ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</h3>
                    </div>
                `;
            } else {
                const checklistHTML = checklist.map((section, index) => `
                    <div class="alert-card">
                        <!-- ã‚¢ãƒ©ãƒ¼ãƒˆå†…å®¹ã¨åŒã˜ã‚¹ã‚¿ã‚¤ãƒ«ã®ãƒ˜ãƒƒãƒ€ãƒ¼ -->
                        <div class="alert-header">
                            <div class="alert-title-row">
                                <span class="alert-icon">âš ï¸</span>
                                <span class="alert-metric">${section.metric}</span>
                                <span class="alert-timestamp">
                                    ${new Date(section.timestamp).toLocaleString('ja-JP')}
                                </span>
                            </div>
                            <div class="alert-message-row">
                                ${section.alertMessage}
                            </div>
                        </div>

                        <!-- ç¢ºèªäº‹é …ãƒªã‚¹ãƒˆ -->
                        <div class="alert-content">
                            ${section.items.map((item, itemIndex) => `
                                <div class="checklist-item">
                                    <div class="item-priority">
                                        <span class="priority-indicator">âš ï¸</span>
                                        <span class="priority-text">${item.title}</span>
                                    </div>
                                    <div class="item-timestamp">
                                        ${new Date(section.timestamp).toLocaleString('ja-JP')}
                                    </div>
                                    ${item.description ? `
                                        <div class="item-description">
                                            ${item.description.split('\n').map((line, lineIndex) => `
                                                <div>${line}</div>
                                            `).join('')}
                                        </div>
                                    ` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
                
                contentDiv.innerHTML = checklistHTML;
            }
        }

        // æœ€çµ‚ãƒã‚§ãƒƒã‚¯æ™‚é–“ã‚’æ›´æ–°
        function updateLastCheckTime() {
            document.getElementById('lastCheckTime').textContent = new Date().toLocaleString('ja-JP');
        }

        // 10ç§’ã”ã¨ã«æ›´æ–°
        setInterval(() => {
            updateLastCheckTime();
        }, 10 * 1000);
    </script>
</body>
</html> 